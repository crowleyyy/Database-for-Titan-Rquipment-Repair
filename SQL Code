-- Create Equipment table
CREATE TABLE IF NOT EXISTS Equipment (
  SerialNumber INT,
  LastServiceDate DATE CHECK (LastServiceDate <= CURDATE()),  -- Check constraint
  LastServiceDone VARCHAR(255),
  NextPNMDate DATE,
  NeedsParts ENUM('true', 'false', 'part ordered'),
  PartName VARCHAR(255) DEFAULT NULL,
  PartsArrived ENUM('true', 'false', 'N/A'),
  LocationID INT,
  FOREIGN KEY (LocationID) REFERENCES Location(ID)
);

-- Create Location table (if not already created)
CREATE TABLE IF NOT EXISTS Location (
  ID INT PRIMARY KEY AUTO_INCREMENT,
  Name VARCHAR(255),
  Address VARCHAR(255),
  PhoneNumber VARCHAR(20)
);

-- Create ServiceHistory table (if not already created)
CREATE TABLE IF NOT EXISTS ServiceHistory (
  ServiceID INT PRIMARY KEY AUTO_INCREMENT,
  EquipmentSerialNumber INT,
  ServiceDate DATE CHECK (ServiceDate <= CURDATE()), -- Check constraint
  ServiceType VARCHAR(255),
  ServiceDescription VARCHAR(255),
  ServiceNotes VARCHAR(255),
  FOREIGN KEY (EquipmentSerialNumber) REFERENCES Equipment(SerialNumber),
  FOREIGN KEY (EquipmentSerialNumber) REFERENCES Equipment(LocationID)
);

-- Create Shipping table (if not already created)
CREATE TABLE IF NOT EXISTS Shipping (
  ShippingID INT PRIMARY KEY AUTO_INCREMENT,
  EquipmentSerialNumber INT,
  ShippingDate DATE CHECK (ShippingDate <= CURDATE()), -- Check constraint
  ShippingFrom INT,
  ShippingMethod VARCHAR(255),
  TrackingNumber VARCHAR(255),
  ShippingStatus VARCHAR(255),
  FOREIGN KEY (EquipmentSerialNumber) REFERENCES Equipment(SerialNumber),
  FOREIGN KEY (ShippingFrom) REFERENCES Location(ID)
);

-- Create Users table (if not already created)
CREATE TABLE IF NOT EXISTS Users (
  UserID INT PRIMARY KEY AUTO_INCREMENT,
  Username VARCHAR(255) UNIQUE,
  Password VARCHAR(255),
  Email VARCHAR(255),
  CreatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Insert admin user record (if not already inserted)
INSERT INTO Users (Username, Password, Email)
VALUES ('admin', 'admin_password', 'admin@example.com');
